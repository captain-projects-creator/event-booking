<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Login</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .auth { max-width:360px;margin:50px auto;background:#fff;padding:20px;border-radius:8px;box-shadow:0 8px 24px rgba(0,0,0,0.06) }
        .auth input{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #e6e9ee}
        .btn{display:inline-block;padding:10px 14px;border-radius:8px;background:#6b21a8;color:#fff;border:none;cursor:pointer}
    </style>
</head>
<body>
<div class="auth">
    <h2>Login</h2>
    <input id="username" placeholder="Username"/>
    <input id="password" placeholder="Password" type="password"/>
    <div style="margin-top:10px;">
        <button id="loginBtn" class="btn">Login</button>
        <a href="register.html" style="margin-left:10px">Register</a>
    </div>
    <div id="msg" style="margin-top:10px;color:#b91c1c"></div>
</div>

<script>
    document.getElementById('loginBtn').addEventListener('click', async () => {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const res = await fetch('/api/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username, password })
      });
      const data = await res.json();
      if (res.ok && data.token) {
        localStorage.setItem('jwt', data.token);
        localStorage.setItem('username', data.username);
        window.location.href = 'index.html';
      } else {
        document.getElementById('msg').innerText = data.message || 'Login failed';
      }
    });
</script>
</body>
</html>